<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 600">
  <defs>
    <linearGradient id="horizontalGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#3498DB;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#2980B9;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="zoomGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#9B59B6;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#8E44AD;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="lazyGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#27AE60;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#1E8449;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="successGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#2ECC71;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#27AE60;stop-opacity:1" />
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.2"/>
    </filter>
    <marker id="arrowGreen" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#27AE60"/>
    </marker>
    <marker id="arrowBlue" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#3498DB"/>
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="450" y="35" text-anchor="middle" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#333">
    方案二：分离手势处理器架构
  </text>
  
  <!-- Modifier Chain Container -->
  <rect x="50" y="60" width="380" height="480" rx="15" fill="#f8f9fa" stroke="#dee2e6" stroke-width="2" filter="url(#shadow)"/>
  <text x="240" y="90" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#333">
    Modifier Chain
  </text>

  <!-- pointerInput #1: Horizontal Scroll -->
  <g transform="translate(70, 110)">
    <rect x="0" y="0" width="340" height="120" rx="10" fill="url(#horizontalGrad)" filter="url(#shadow)"/>
    <text x="170" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" fill="white" font-weight="bold">
      pointerInput #1: 水平滚动
    </text>
    <line x1="20" y1="45" x2="320" y2="45" stroke="rgba(255,255,255,0.3)" stroke-width="1"/>
    <text x="20" y="65" font-family="Arial, sans-serif" font-size="11" fill="rgba(255,255,255,0.9)">• 使用 PointerEventPass.Main</text>
    <text x="20" y="82" font-family="Arial, sans-serif" font-size="11" fill="rgba(255,255,255,0.9)">• 带角度容差的方向检测</text>
    <text x="20" y="99" font-family="Arial, sans-serif" font-size="11" fill="rgba(255,255,255,0.9)">• 垂直滑动时立即退出，不消费事件</text>
    
    <!-- Badge -->
    <rect x="260" y="5" width="70" height="20" rx="10" fill="rgba(255,255,255,0.2)"/>
    <text x="295" y="19" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">单指手势</text>
  </g>
  
  <!-- Arrow down -->
  <line x1="240" y1="235" x2="240" y2="255" stroke="#666" stroke-width="2"/>
  <polygon points="235,255 245,255 240,265" fill="#666"/>
  
  <!-- pointerInput #2: Zoom -->
  <g transform="translate(70, 270)">
    <rect x="0" y="0" width="340" height="100" rx="10" fill="url(#zoomGrad)" filter="url(#shadow)"/>
    <text x="170" y="28" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" fill="white" font-weight="bold">
      pointerInput #2: 缩放
    </text>
    <line x1="20" y1="42" x2="320" y2="42" stroke="rgba(255,255,255,0.3)" stroke-width="1"/>
    <text x="20" y="62" font-family="Arial, sans-serif" font-size="11" fill="rgba(255,255,255,0.9)">• 使用 PointerEventPass.Initial</text>
    <text x="20" y="79" font-family="Arial, sans-serif" font-size="11" fill="rgba(255,255,255,0.9)">• 只处理多指手势，单指时不干预</text>
    
    <!-- Badge -->
    <rect x="260" y="5" width="70" height="20" rx="10" fill="rgba(255,255,255,0.2)"/>
    <text x="295" y="19" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">多指手势</text>
  </g>
  
  <!-- Arrow down -->
  <line x1="240" y1="375" x2="240" y2="395" stroke="#666" stroke-width="2"/>
  <polygon points="235,395 245,395 240,405" fill="#666"/>
  
  <!-- LazyColumn -->
  <g transform="translate(70, 410)">
    <rect x="0" y="0" width="340" height="100" rx="10" fill="url(#lazyGrad)" filter="url(#shadow)"/>
    <text x="170" y="28" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" fill="white" font-weight="bold">
      LazyColumn 滚动处理
    </text>
    <line x1="20" y1="42" x2="320" y2="42" stroke="rgba(255,255,255,0.3)" stroke-width="1"/>
    <text x="20" y="62" font-family="Arial, sans-serif" font-size="11" fill="rgba(255,255,255,0.9)">• 接收未被消费的垂直滚动事件</text>
    <text x="20" y="79" font-family="Arial, sans-serif" font-size="11" fill="rgba(255,255,255,0.9)">• 自然处理页面滚动</text>
    
    <!-- Badge -->
    <rect x="250" y="5" width="80" height="20" rx="10" fill="rgba(255,255,255,0.2)"/>
    <text x="290" y="19" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">垂直滚动</text>
  </g>
  
  <!-- Right side: Flow diagram -->
  <g transform="translate(480, 80)">
    <rect x="0" y="0" width="380" height="460" rx="15" fill="#E8F8F5" stroke="#1ABC9C" stroke-width="2"/>
    <text x="190" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#1E8449">
      ✅ 事件流向
    </text>
    
    <!-- Touch event -->
    <circle cx="190" cy="70" r="25" fill="#E74C3C"/>
    <text x="190" y="75" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white" font-weight="bold">触摸</text>
    
    <!-- Decision diamond -->
    <polygon points="190,120 240,160 190,200 140,160" fill="#F39C12" stroke="#E67E22" stroke-width="2"/>
    <text x="190" y="155" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">方向</text>
    <text x="190" y="168" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">检测</text>
    
    <!-- Arrow from touch to decision -->
    <line x1="190" y1="95" x2="190" y2="120" stroke="#666" stroke-width="2"/>
    
    <!-- Horizontal path -->
    <line x1="240" y1="160" x2="300" y2="160" stroke="#3498DB" stroke-width="2" marker-end="url(#arrowBlue)"/>
    <rect x="305" y="140" width="60" height="40" rx="5" fill="#3498DB"/>
    <text x="335" y="165" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">水平</text>
    <text x="280" y="150" font-family="Arial, sans-serif" font-size="9" fill="#3498DB">|dx|>|dy|×2</text>
    
    <!-- Vertical path -->
    <line x1="190" y1="200" x2="190" y2="250" stroke="#27AE60" stroke-width="2" marker-end="url(#arrowGreen)"/>
    <rect x="160" y="255" width="60" height="40" rx="5" fill="#27AE60"/>
    <text x="190" y="280" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">垂直</text>
    <text x="220" y="225" font-family="Arial, sans-serif" font-size="9" fill="#27AE60">其他</text>
    
    <!-- Multi-touch path -->
    <line x1="140" y1="160" x2="80" y2="160" stroke="#9B59B6" stroke-width="2"/>
    <line x1="80" y1="160" x2="80" y2="220" stroke="#9B59B6" stroke-width="2"/>
    <rect x="50" y="225" width="60" height="40" rx="5" fill="#9B59B6"/>
    <text x="80" y="250" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">缩放</text>
    <text x="60" y="150" font-family="Arial, sans-serif" font-size="9" fill="#9B59B6">多指</text>
    
    <!-- Results -->
    <g transform="translate(0, 310)">
      <rect x="20" y="0" width="340" height="130" rx="10" fill="rgba(255,255,255,0.8)" stroke="#1ABC9C" stroke-width="1"/>
      <text x="190" y="25" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#333">处理结果</text>
      
      <circle cx="50" cy="55" r="8" fill="#3498DB"/>
      <text x="70" y="60" font-family="Arial, sans-serif" font-size="11" fill="#333">水平 → K线图处理 + consume()</text>
      
      <circle cx="50" cy="85" r="8" fill="#27AE60"/>
      <text x="70" y="90" font-family="Arial, sans-serif" font-size="11" fill="#333">垂直 → 立即退出 → LazyColumn 处理</text>
      
      <circle cx="50" cy="115" r="8" fill="#9B59B6"/>
      <text x="70" y="120" font-family="Arial, sans-serif" font-size="11" fill="#333">缩放 → K线图处理 + consume()</text>
    </g>
  </g>
</svg>
